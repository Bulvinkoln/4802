# Инструкция для работы с Git и удалёнными репозиториями

## Что такое Git?

Git - это одна из реализаций распределённых систем контроля версий, имеющая как и локальные, так и удалённые репозитории. Является самой популярной реализацией систем контроля версий в мире.

## Подготовка репозитория

Для создания репозитория необходимо выполнить команду *git init*  в папке с репозиторием, и у Вас создастся репозиторий (появится скрытая папка .git)

## Создание коммитов

### Git add

Для добавления измений в коммит используется команда *git add*. Чтобы использовать команду *git add* напишите *git add <имя файла>*

### Просмотр состояния репозитория

Для того, чтобы посмотреть состояние репозитория используется команда *git status*. Для этого необходимо в папке с репозиторием написать *git status*, и Вы увидите были ли измения в файлах, или их не было.

### Создание коммитов

Для того, чтобы создать коммит(сохранение) необходимо выполнить команду *git commit*. Выполняется она так: *git commit -m "<сообщение к коммиту>*. Все файлы для коммита должны быть ***ДОБАВЛЕНЫ*** и сообщение к коммиту писать ***ОБЯЗАТЕЛЬНО***.

## Перемещение между сохранениями

Для того, чтобы перемещаться между коммитами, используется команда *git checkout*. Используется она в папке с репозиторием следующим образом: *git checkout <номер коммита>*

## Журнал изменений

Для того, чтобы посмотреть все сделанные изменения в репозитории, используется команда *git log*. Для этого достаточно выполнить команду *git log* в папке с репозиторием

## Ветки в Git

### Создание ветки

Для того, чтобы создать ветку, используется команда *git branch*. Делается это следующим образом в папке с репозиторием: *git branch <имя новой ветки>*

### Слияние веток

Для того чтобы дабавить ветку в текущую ветку используется команда *git merge <имя branch>*

### Удаление веток

Для удаления ветки ввести команду *git branch -d <имя branch>*

## Работа с изображениями

Для того чтобы вставить изображение в текст нужно написать следующее:
![Название изображения](имя файла с изображением с указанием расширения)
Например:
![Это картинка](катинка.расширение)
## Синтаксис языка Markdown

### Ненумерованные списки

Для создания ненумерованных списков необходимо обозначить "звездочку" в начале строки.
Например:

* список 1
* список 2

### Нумерованные списки

Для создания нумерованных списков достаточно написать цифру-номер строки.
Например:

1. Список 1
2. Список 2

### Вложенные списки

Для создания вложенного списка необходимо поставить перед его пунктами табуляцию или несколько пробелов. В Markdown одна табуляция соответствует четырем пробелам.

### Жирный текст

Для выделения текста жирным шрифтом необходимо поставить перед текстом и в конце текста по две звездочки.
Например:

**жирный текст**

### Курсивный текст

Для выделения текста курсивом необходимо поставить перед текстом и в конце текста по одной звездочке.
Например:

*курсивный текст*

### Зачеркнутый текст

Для зачеркнутого текста необходимо поставить по два знака тильда в начале и в конце текста.
Например:

~~зачеркнутый текст~~

## Работа с удаленными репозиториями

### Что такое удаленный репозиторий?

Удаленный (иногда говорят "внешний") репозиторий – это версии вашего проекта, сохраненные на удаленном сервере. Доступ к репозиторию на таком сервере может осуществляться по интернету или по локальной сети.

Удаленный репозиторий – полноценный репозиторий, ничем не отличающийся от локального. У удаленного репозитория есть собственные ветки, собственный указатель HEAD, своя история коммитов и так далее.

Если мы подключим удаленный репозиторий к своему локальному, то у нас появятся копии всех ссылочных объектов удаленного репозитория. То есть, например, у удаленного репозитория есть ветка main, а у нас будет копия этой ветки – origin/main. Все такие ссылочные объекты (указатели, ветки и теги) удаленного репозитория хранятся почти там же, где и у локального – в директории .git/refs/remotes/<имя_удаленного_репозитория>. 

* *Принято называть удаленные ветки (то есть ветки удаленных репозиториев), приписывая к их названию имя удаленного репозитория. Например, если у нас есть удаленный репозиторий с именем origin и веткой main, то мы будем называть такую ветку origin/main. То же мы будем делать и со всеми остальными ссылочными объектами. Это может показаться излишним, но на самом деле это добавляет определенности и позволяет не запутаться в многочисленных названиях веток.*

 ### Настройка подключения удаленного репозитория. Группа команд git remote. 

 Необходимость подключить удаленный репозиторий к уже существующему локальному возникает в ситуациях, когда вы решаете выгрузить уже написанный код на удаленный сервер. Это нужно, чтобы другие разработчики смогли получить к нему доступ или чтобы вы сами могли заниматься разработкой с нескольких компьютеров (например, домашнего и рабочего). 

Для управления подключением удаленных репозиториев в Git предусмотрена целая группа команд – git remote. Мы рассмотрим самые частоиспользуемые команды из этой группы.

#### *Добавление удаленного репозитория к существующему локальному. Команда git remote add* 

Для того чтобы добавить удаленный репозиторий к вашему локальному репозиторию, необходимо выполнить команду git remote add.

Формат команды:
*git remote add <название удаленного репозитория> <ссылка на удаленный репозиторий>*

Пример:

*Подключим удаленный репозиторий под именем origin $ git remote add origin git@github.com:smartiqaorg/geometric_lib.git*

Имя удаленного репозитория в команде git remote add вы можете придумать сами. Впоследствии, при работе с этим удаленным репозиторием, вы будете обращаться к нему по придуманному имени. Принято называть удаленный репозиторий origin, но строго говоря, никаких ограничений здесь нет. 

Со ссылкой на удаленный репозиторий тоже все просто. Мы работаем с GitHub, поэтому эту ссылку можно взять, нажав на большую зеленую кнопку Code на странице репозитория на GitHub.

Вам предложат выбрать одну из трех ссылок: для протоколов https и ssh и для клиента GitHub на компьютер. Вот примеры этих трех ссылок для репозитория geometric_lib известного вам по практическим занятиям этого курса:

1. HTTPS-ссылка: https://github.com/smartiqaorg/geometric_lib.git
2. SSH-ссылка: git@github.com:smartiqaorg/geometric_lib.git
3. GitHub CLI ссылка: gh repo clone smartiqaorg/geometric_lib

Давайте разберемся, в чем отличие. Начнем с последней - эта ссылка используется в клиенте GitHub, который нужен для упрощения работы с Git. Этот клиент можно поставить отдельно, но его возможности значительно ограничены по сравнению с консольным вариантом Git. 

Итак, с последней ссылкой все понятно: ее нужно использовать в специальной программе для компьютера с графическим UI от создателей GitHub. Но в чем разница между первыми двумя? 

Дело в том, что существует два основных протокола подключения к git-серверу: HTTPS и SSH. SSH считается более надежным, но он немного сложнее в настройке. Давайте разберемся, как настроить подключение для каждого из них.

#### Настройка подключения по HTTPS

Раньше можно было подключаться по HTTPS, используя имя пользователя и пароль от аккаунта GitHub. Но потом эту возможность отключили в целях безопасности. Сейчас вместо пароля нужно использовать персональный токен.

Чтобы создать токен персонального доступа, следуйте инструкции: 
1. Подтвердите свой email-адрес, который вы использовали при регистрации аккаунта GitHub (если он не подтвержден).
2. Кликните на свою аватарку в правом верхнем углу, в открывшемся окне выберите Settings (Настройки):
3. Перед вами откроются настройки. В меню слева выберите Developer settings (Настройки разработчика).
4. Перед вами откроются Настройки разработчика. В меню слева выберите Personal access tokens (токены персонального доступа).
5. Нажмите Generate new token (сгенерировать новый токен). 
6. Придумайте имя для своего токена. Имя должно описывать, зачем токен был создан. 
7. Дайте токену разрешения. Пользователь токена сможет выполнять с удаленным репозиторием только то, что вы указали в этих разрешениях. Чтобы дать токену доступ к управлению удаленным репозиторием из командной строки, выберите repo.
8. Нажмите Generate token (сгенерировать токен).
Токен выглядит так:

*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*

9. Скопируйте токен. В целях безопасности, как только вы покинете страницу создания токена, вы больше не сможете просмотреть этот токен. 

При первой загрузке/скачивании изменений из удаленного репозитория, вас попросят ввести имя пользователя на GitHub и пароль. Нужно будет ввести свое имя пользователя, а вместо пароля вставить этот токен. 

#### Настройка подключения по SSH 

Чтобы настроить подключение по SSH, вам нужно на своем компьютере сгенерировать два SSH-ключа: публичный (public) и секретный (private). 

*Как работает SSH протокол и зачем ему ключи? Если коротко, то публичный ключ передается на удаленный сервер, а секретный все время остается с вами. Удаленный сервер использует публичный ключ, чтобы удостовериться, что у вас действительно есть секретный ключ. Как только сервер убеждается в наличии у вас секретного ключа, он понимает, что вы – это вы, ведь секретный ключ нельзя подделать.*

После создания пары ключей, надо добавить секретный ключ в SSH-агента. 

*SSH-агент – это специальная программа, которая сохраняет пароль от файла с секретным ключом и помогает удаленному серверу удостовериться, что вы действительно владеете секретным ключом. Благодаря SSH-агенту, вам не потребуется при каждом подключении к удаленному серверу вводить пароль от файла с приватным ключом.*

После останется только загрузить наш публичный ключ на GitHub и готово. Давайте рассмотрим этот процесс подробнее:

1. Откройте Git Bash (или терминал, если вы работаете на Linux/MacOS) 
2. Выполните в нем команду ssh-keygen -t rsa 4096 -C "<ваша-почта>@example.com"
* Вам предложат ввести путь к директории, в которой будет сохранен ключ, а также будет выведена директория для сохранения по умолчанию. Нажмите Enter, чтобы выбрать директорию по умолчанию, либо введите любую другую директорию и тоже нажмите Enter. 
* Затем вам предложат ввести пароль для файла с секретным ключом. Нажмите Enter, чтобы оставить файл без пароля, либо введите пароль и нажмите Enter. 
3. Теперь нужно добавить ключ в SSH-агента. Запустим агента командой eval `ssh-agent -s` 
4. Теперь выполните команду ssh-add <путь до приватного ключа>. Если вы оставили путь по умолчанию, ваша команда будет выглядеть так: ssh-add ~/.ssh/id_ed25519 
5. Отлично, последний этап: добавляем публичный ключ на GitHub. Для этого откройте файл с публичным ключом (он должен иметь расширение .pub). Если вы оставили путь по умолчанию, то ваш ключ будет располагаться по адресу ~/.ssh/id_ed25519.pub. 
6. Скопируйте содержимое файла. 
7. Перейдите в настройки GitHub.
8. Откройте раздел SSH and GPG keys (ssh и gpg ключи).
9. Нажмите New SSH key (новый ssh-ключ). 
10. В поле Title (заголовок) введите содержательное название ключа, например ключ для ноутбука или ключ рабочего компьютера.
11. Скопированный ключ вставьте в раздел Key (ключ) 
12. Нажмите Add SSH key (добавить ssh-ключ) 
13. Возможно потребуется ввести пароль для подтверждения действия. 

Теперь SSH-ключ добавлен. Вам больше не нужно вводить имя пользователя и пароль при каждой загрузке или скачивании изменений из удаленного репозитория.

#### Отключение удаленного репозитория от локального. Команда git remote remove

Иногда возникает необходимость забыть удаленный репозиторий. Для этого существует команда git remote remove.

Формат команды:
*git remote remove <название удаленного репозитория>*

Пример:
*Отключим удаленный репозиторий с именем origin*

$ git remote remove origin 

Данная команда предельно проста в использовании. В качестве имени репозитория нужно передавать то имя, которое вы указывали в команде git remote add. Данная команда не удаляет удаленный репозиторий с сервера, она удаляет только подключение вашего репозитория к удаленному.

#### Изменение имени удаленного репозитория. Просмотр всех удаленных репозиториев. Команды git remote rename, git remote show.

Иногда возникает необходимость переименовать удаленный репозиторий. Для этого существует команда git remote rename.

Формат команды:
*git remote rename <старое имя удаленного репозитория> <новое имя удаленного репозитория>*

Например:
*Переименуем удаленный репозиторий с origin на upstream*

$ git remote rename origin upstream

Еще более частая задача – просмотреть список всех подключенных удаленных репозиториев и получить информацию о каждом из них. Для этого существует команда git remote show. 

Формат команды:
*git remote show [имя удаленного репозитория]*

Например:

Выведем список всех удаленных репозиториев:

$ git remote show 

origin 

upstream 

Выведем информацию про репозиторий origin 

$ git remote show origin 

*remote origin 

Fetch URL: git@github.com:smartiqaorg/geometric_lib.git 

Push URL: git@github.com:smartiqaorg/geometric_lib.git 

HEAD branch: develop 

Remote branch: 

develop new (next fetch will store in remotes/origin) 

Local ref configured for 'git push': 

dev pushes to develop (up to date)

Таким образом можно просмотреть информацию о каждом из подключенных удаленных репозиториев. 

#### Клонирование удаленного репозитория. Команда git clone.

Необходимость клонировать существующий удаленный репозиторий возникает в ситуациях, когда вы решаете поработать над уже существующим кодом. Для выполнения этой операции в Git предусмотрена команда git clone.

Формат команды:
*git clone <ссылка на удаленный репозиторий>*

Например: 
*Склонируем себе репозиторий geometric_lib*

$ git сlone https://github.com/smartiqaorg/geometric_lib.git

Ссылку на удаленный репозиторий можно получить тем же способом, что мы разбирали выше. Нужно нажать на зеленую кнопку Code на главной странице репозитория на GitHub.

Клонирование по https возможно вообще всегда, а по ssh – нет. Чтобы клонировать репозитории по ssh, нужно, чтобы владелец удаленного репозитория на GitHub добавил к себе публичный ssh-ключ из пары, в то время, как секретный ssh-ключ от той же пары хранится у вас на компьютере, с которого вы выполняете git clone. Таким образом, если вы настроили ssh в своем аккаунте, то вы сможете беспрепятственно клонировать свои репозитории и по https, и по ssh. Но если вы пытаетесь клонировать чужой репозиторий по ssh, то скорее всего получите ошибку доступа.

* Как происходит клонирование. Клонируем уже знакомый нам репозиторий geometric_lib. При выполнении команды git сlone https://github.com/smartiqaorg/geometric_lib.git произойдет следующее:

В директории, откуда вы запустили команду git clone, создается директория с именем репозитория. В нашем случае, если мы выполнили команду из директории пользователя, будет создана папка C:\users\smartiqa\geometric_lib\.
В созданную директорию копируется репозиторий, все его ветки и коммиты.
В новосозданный локальный репозиторий добавляется удаленный репозиторий с именем origin и ссылкой, которую мы передавали в git clone. Это избавляет нас от необходимости вручную писать git remote add origin https://github.com/smartiqaorg/geometric_lib.git. На этом процесс клонирования заканчивается.

Кстати!
*Вместо git clone можно было бы создать пустой локальный git-репозиторий, выполнив команду git init. Затем подключить наш удаленный репозиторий командой git remote add origin https://github.com/smartiqaorg/geometric_lib.git. После чего вручную загрузить изменения с удаленного репозитория командой git pull, которую мы рассмотрим ниже. Но зачем делать что-то вручную, если для этого есть автоматизированный инструмент из коробки.*

#### Получение изменений из удаленного репозитория. Команда git fetch

Теперь, когда мы научились подключать удаленный репозиторий к локальному и клонировать его к себе на компьютер, пора узнать, как же получить изменения из удаленного репозитория. 

У вас может возникнуть вопрос: зачем получать изменения, если только я загружаю их в свой удаленный репозиторий? Все верно, если вы работаете один, то вряд ли вам пригодится загружать изменения из удаленного репозитория в локальный. Но если вы работаете в команде, вы будете по несколько раз в день обновлять свой репозиторий, загружая в него коммиты, сделанные другими разработчиками из вашей команды. 

Итак, чтобы получить изменения из удаленного репозитория, в Git предусмотрена команда git fetch.

Формат команды:
*git fetch [ключи] [имя удаленного репозитория]*

Эта команда получает изменения из переданного удаленного репозитория. Если не было передано ни одного удаленного репозитория, ни ключа --all, команда пытается получить изменения из репозитория с именем origin.

Например:
*Получим изменения из удаленного репозитория*
$ git fetch origin 

Команда не обновляет рабочую копию в соответствии с удаленным репозиторием. Она обновляет только ссылочные объекты (указатели, ветки и теги) и скачивает все необходимые файлы в директорию .git/objects. 

Команда git fetch используется для синхронизации локальных ссылочных объектов с этими же объектами в удаленном репозитории. Рабочую копию она не меняет. 
Чтобы синхронизировать локальную рабочую копию с удаленным репозиторием, нужно слить удаленные ветки в локальные. Сделать это можно уже знакомой командой git merge.

#### Получение изменений из удаленного репозитория. Команда git pull

Связкой git fetch && git merge мы получили изменения из удаленного репозитория и обновили свою рабочую копию. Часто вместо этого хочется получать изменения и сразу обновлять рабочую копию так, чтобы она соответствовала удаленному репозиторию. И для этого в Git существует отдельная команда. Называется она git pull. 

Формат команды:
*git pull [ключи] [имя удаленного репозитория]*

Например:
*Обновим нашу рабочую копию в соответствии с удаленным репозиторием* 
$ git fetch origin

Получает изменения из переданного удаленного репозитория и обновляет рабочую копию в соответствии с удаленным репозиторием. По умолчанию слияние удаленной ветки с локальной происходит именно в fast-forward режиме, так что включать его специально не требуется.

Команда git pull используется для синхронизации локальной рабочей копии и всех ссылочных объектов с удаленным репозиторием. 
По сути, git pull - это то же самое, что git fetch + git merge. 

#### Отправка изменений в удаленный репозиторий. Команда git push

Для загрузки в удаленный репозиторий свои локальные изменения, существует команда git push. 

Формат команды:
*git push [ключи] [имя удаленного репозитория] [имя ветки]*

Например, загрузим все изменения с текущей ветки в удаленный репозиторий 
$ git push origin develop 

Эта команда загружает изменения в удаленный репозиторий. Если слияние изменений в удаленном репозитории нельзя сделать в режиме fast-forward, и при этом не был передан ключ force, выполнение закончится с ошибкой. 

По факту данная команда аналогична связке git fetch + git merge, но выполненной из удаленного репозитория (это просто аналогия, на самом деле так сделать не получится). 

Давайте более подробно разберем, как работает эта команда. Допустим, мы выполнили git push origin develop в нашем локальном репозитории. Возможны три варианта развития событий. 

Если изменения с нашей ветки можно слить с удаленной веткой в режиме fast-forward, то есть на удаленной ветке нет коммитов сделанных после наших, то все пройдет нормально. 

Если на удаленной ветке есть коммиты, которые были сделаны позже наших, то есть слияние в режиме fast-forward выполнить невозможно, то команда завершится с ошибкой. Ведь в этом случае есть угроза перезаписи истории удаленного репозитория и удаления всех коммитов, созданных позже наших. 

Но если вы вдруг передали флаг --force, то все коммиты, которых нет в вашем локальном репозитории, будут удалены. То есть удаленный репозиторий станет точной копией вашего локального. Есть более щадящая версия этого флага – --force-with-lease. Он будет делать в точности то же самое, но если вдруг нужно будет удалить коммит, созданный не вами, выполнение немедленно прекратится и вернется ошибка. Таким образом, вы не попадете в ситуацию, когда вы случайно удалили чужой коммит. 

### GitHub. Работа с репозиторием, создание форков и пулл-реквестов

#### Создание репозитория на GitHub

Прежде всего необходимо зарегистрироваться на GitHub. После регистрации вы попадете на главную страницу. На ней будут отображаться действия людей, на которых вы подписались и обновления в репозиториях, которые вы добавили в избранное. 

Чтобы создать свой репозиторий, нажмите на зеленую кнопку "New".
Перед вами откроется страница создания репозитория:

Первое поле Repository name – имя репозитория. Здесь все просто, нужно придумать имя, которое будет отображаться на странице вашего репозитория. Здесь нет никаких ограничений, но старайтесь давать как можно более содержательные имена своим репозиториям.

Второе поле – Description – описание. Его заполнять необязательно. Но другим пользователям, которые попали на страницу вашего репозитория, будет проще понять, что перед ними, если вы заполните графу описания.

Затем вы можете выбрать, будет ли репозиторий открытым, то есть доступным абсолютно всем пользователям GitHub, или закрытым, то есть доступным только вам и людям, которым вы предоставите доступ.

Последние три поля предлагают нам добавить, соответственно, README-файл, .gitignore файл и выбрать лицензию для нашего проекта.

Завершим процесс создания репозитория, нажав кнопку Create repository. 

#### Создание форка репозитория на GitHub. Пулл-реквесты. 

Форк (от англ. fork – вилка) – точная копия репозитория, но в вашем аккаунте. Форки нужны, чтобы вносить свои изменения в проект, к репозиторию которого у вас нет прямого доступа. 

Пулл-реквест (от англ. pull-request – запрос pull) – функция GitHub, позволяющая попросить владельца репозитория, от которого мы сделали форк, загрузить наши изменения обратно в свой репозиторий. 

Если коротко, форки и пулл-реквесты нужны, чтобы любой пользователь мог внести свой вклад в любой открытый проект, репозиторий которого есть на GitHub. Кроме того, перед тем как влить ваши изменения в основной репозиторий, ответственные обязательно проверят ваш код на наличие ошибок и уязвимостей. Таким образом, даже если ваши изменения не примут, вы получите первоклассный code-review с указанием всех неточностей. 

Теперь давайте рассмотрим пайплайн контрибуции (англ. contribution – внесение вклада) на примере реального репозитория. То есть научимся вносить свой вклад в разработку проектов с открытым исходным кодом на GitHub.

1. Для начала зайдем на страницу репозитория проекта. Нажимаем на кнопку Fork. После этого Git создаст точную копию этого репозитория в вашем аккаунте. 
2. Клонируем репозиторий к себе на компьютер командой git clone. Создадим файл README.md с описанием проекта, чтобы другим пользователям было понятно, в чем отличие этой реализации от остальных.
3. Сделаем коммит и выполним git push, чтобы загрузить наши изменения в удаленный репозиторий.
4. Теперь GitHub подсказывает нам, что наша ветка опережает ветку исходного репозитория на один коммит и предлагает сделать пулл-реквест.
5. Нажимаем на кнопку Compare на подсказке GitHub, либо переходим на вкладку Pull Requests и нажимаем New pull request.
6. Перед нами откроется страница создания пулл-реквеста.
Здесь мы можем просмотреть внесенные изменения и выбрать две ветки: одну в исходном репозитории, на нее будут залиты наши изменения, вторую – в нашем репозитории, с нее будут скачаны изменения. Как только мы выбрали ветки и убедились, что не внесли никаких лишних изменений, нажимаем кнопку Create pull request.
7. Теперь мы попадаем на страницу описания наших изменений.
Здесь необходимо описать, что за изменения вы внесли и почему они были необходимы. Сообщение, отражает суть и необходимость внесенных изменений. Как только мы закончили с описанием, можно нажимать кнопку Create pull request.
8. Теперь мы попадаем на страницу уже созданного пулл-реквеста в изначальном репозитоии.

После того, как владелец репозитория просмотрит наши изменения и убедится, что они не имеют вредоносный характер, он сможет принять наш пулл-реквест. Тогда все изменения, добавленные в этот пулл-реквест нами, будут залиты в исходный репозиторий.
